<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Unsplash Test</title>
    <style>
        body {
            font-family: Arial, Helvetica, sans-serif;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
            background: #f5f5f5;
        }
        .test-box {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #0056b3;
        }
        #result {
            margin-top: 20px;
            white-space: pre-wrap;
            direction: rtl;
        }
        img {
            max-width: 300px;
            border-radius: 8px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª Ø§Ø®ØªØ¨Ø§Ø± Ø£Ø¯Ø§Ø© Unsplash</h1>
    
    <div class="test-box">
        <h2>Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª:</h2>
        <button onclick="test1()">Test 1: Ù…Ù†Ø¸Ø± Ø·Ø¨ÙŠØ¹ÙŠ ÙÙŠ Ø§Ù„Ø¬Ø¨Ø§Ù„</button>
        <button onclick="test2()">Test 2: city skyline</button>
        <button onclick="test3()">Test 3: ØªÙ†ÙŠÙ† Ù†Ø§Ø±ÙŠ (ÙØ§Ù†ØªØ§Ø²ÙŠ)</button>
    </div>
    
    <div class="test-box">
        <h2>Ø§Ù„Ù†ØªÙŠØ¬Ø©:</h2>
        <div id="result">Ø§Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø£Ø­Ø¯ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª Ø£Ø¹Ù„Ø§Ù‡...</div>
    </div>

    <script>
        async function sendTest(message) {
            const result = document.getElementById('result');
            result.innerHTML = 'â³ ÙŠØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...';
            
            try {
                const response = await fetch('http://localhost:8000/webhook', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        user_id: 'test_user',
                        message: message,
                        platform: 'web'
                    })
                });
                
                const data = await response.json();
                
                // Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªÙŠØ¬Ø©
                result.innerHTML = `
                    <strong>Ø§Ù„Ø±Ø¯ Ù…Ù† Ø§Ù„Ø¨ÙˆØª:</strong><br><br>
                    ${formatMessage(data.response)}
                `;
                
            } catch (error) {
                result.innerHTML = `âŒ Ø®Ø·Ø£: ${error.message}`;
            }
        }
        
        function formatMessage(text) {
            // ØªØ­ÙˆÙŠÙ„ markdown Ù„Ù„ØµÙˆØ±
            text = text.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, '<br><img src="$2" alt="$1"><br>');
            // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø±ÙˆØ§Ø¨Ø·
            text = text.replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2" target="_blank">$1</a>');
            // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø³Ø·ÙˆØ± Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
            text = text.replace(/\n/g, '<br>');
            return text;
        }
        
        function test1() {
            sendTest('/unsplash Ø£Ø±ÙŠØ¯ ØµÙˆØ±Ø© Ù„Ù…Ù†Ø¸Ø± Ø·Ø¨ÙŠØ¹ÙŠ ÙÙŠ Ø§Ù„Ø¬Ø¨Ø§Ù„');
        }
        
        function test2() {
            sendTest('/unsplash city skyline at sunset');
        }
        
        function test3() {
            sendTest('/unsplash ØªÙ†ÙŠÙ† Ù†Ø§Ø±ÙŠ ÙÙŠ Ù…Ø¯ÙŠÙ†Ø© Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ©');
        }
    </script>
</body>
</html>
